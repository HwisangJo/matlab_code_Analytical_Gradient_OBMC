function [y,grad_y] = model_ex_mult_resp(xx,y_num)
% x1 = xx(:,1);
% x2  = xx(:,2);

if y_num==1
    x1 = xx(:,1);
x2  = xx(:,2);
    
    t = 1 / (8*pi);    s = 10;    r = 6;    c = 5/pi;
    b = 5.1 / (4*pi^2);    a = 1;
    term1 = a * (x2 - b*x1.^2 + c*x1 - r).^2;
    term2 = s*(1-t)*cos(x1);
    y = term1 + term2 + s;
    if nargout>1
        grad_y=[2*a*(x2-b*x1.^2+c*x1-r).*(-2*b*x1+c)-s*(1-t)*sin(x1) ...
            2*a*(x2-b*x1.^2+c*x1-r)];
    end
elseif y_num==2
    x1 = xx(:,1);
    x2  = xx(:,2);

% y=sqrt(x1.*x2./(x1.^2+x1+1));
y=(x2.*x1.^2+x1)./(x2.^2+x2+1);

if nargout>1
%     grad_y=[0.5*(x1.*x2./(x1.^2+x1+1)).^-0.5.*x2.*(1-x1.^2)./(x1.^2+x1+1).^2 ...
%         0.5*x2.^-0.5.*(x1./(x1.^2+x1+1)).^0.5];
    grad_y=[(2*x1.*x2+1)./(x2.^2+x2+1) ... 
    (x1.^2.*(x2.^2+x2+1)-(x2.*x1.^2+x1).*(2*x2+1))./(x2.^2+x2+1).^2];
end
end


%     x1 = xx(:,2);
% x2  = xx(:,1);
% % y=sqrt(x1.*x2./(x1.^2+x1+1));
% y=(x1.*x2.^2+x2)./(x1.^2+x1+1);
% 
% if nargout>1
% %     grad_y=[0.5*(x1.*x2./(x1.^2+x1+1)).^-0.5.*x2.*(1-x1.^2)./(x1.^2+x1+1).^2 ...
% %         0.5*x2.^-0.5.*(x1./(x1.^2+x1+1)).^0.5];
%     grad_y=[(2*x1.*x2+1)./(x1.^2+x1+1) ... 
%     (x2.^2.*(x2.^2+x2+1)-(x1.*x2.^2+x2).*(2*x1+1))./(x1.^2+x1+1).^2];
% end


